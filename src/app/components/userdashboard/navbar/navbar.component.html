<p-toast position="top-left"></p-toast>
<div class="card">
  <p-menubar [model]="items">
      <ng-template #start>
         <div class="logo"><img src="data:image/png;base64,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" alt="">
</div>
      </ng-template>
      <ng-template #item let-item let-root="root">
          <a pRipple class="flex items-center p-menubar-item-link">
              <span>{{ item.label }}</span>
              <p-badge *ngIf="item.badge" [ngClass]="{ 'ml-auto': !root, 'ml-2': root }" [value]="item.badge" />
              <span *ngIf="item.shortcut" class="ml-auto border border-surface rounded bg-emphasis text-muted-color text-xs p-1">{{ item.shortcut }}</span>
              <i *ngIf="item.items" [ngClass]="['ml-auto pi', root ? 'pi-angle-down' : 'pi-angle-right']"></i>
          </a>
      </ng-template>
      <ng-template #end>
          <div class="flex items-center gap-3">
              <input type="text" pInputText placeholder="Search" class="w-36" />
              <i class="pi pi-shopping-cart" style="font-size: 2rem; cursor: pointer;" (click)="openDialog()" ></i>
              <i class="pi pi-user" style="font-size: 2rem; cursor: pointer;" (click)="openProfile()" ></i>
          </div>
      </ng-template>
  </p-menubar>
</div>

<!-- 2 for cart-->
<p-drawer header="Your Cart" [(visible)]="visible2" position="right" [style]="{ width: '35rem' }">
  <div *ngFor="let item of cartItems; let i = index" class="item-card-n" style="padding: 1rem; display: flex; height: fit-content; width: 100%;">
    <div class="image">
      <img style="height: 10rem; width: 10rem;" [src]="item.image" alt="">
    </div>
    <div class="details" style="width: 100%; display: flex; flex-direction: column; justify-content: space-between;">
      <div class="top-detail" style="padding-left: 2rem; display: flex; justify-content: space-between; align-items: center; width: 100%;">
        <h3 style="font-size: 2rem;">{{ item.name }}</h3>
        <i class="pi pi-trash" style="margin-right: 2.6rem; font-size: 1.3rem; cursor: pointer; color: rgb(223, 54, 54);" (click)="removeItem(item.itemId)"></i>
      </div>
      <div class="bottom-detail" style="padding-left: 2rem; display: flex; justify-content: space-between;">
        <p style="font-size: 1.2rem; font-weight:400;">&#8377; {{ item.price }}</p>
        <div style="display: flex; border: 1px solid black; border-radius: 10px; justify-content: space-around; height: 50%; width: 30%; margin-top:1rem; align-items: center;">
          <i class="pi pi-minus" style="cursor: pointer;" (click)="updateQuantity(item.itemId, -1)"></i>
          <p>{{ item.quantity }}</p>
          <i class="pi pi-plus" style="cursor: pointer;" (click)="updateQuantity(item.itemId, 1)"></i>
        </div>
      </div>
    </div>
  </div>

  <ng-template #footer>
    <div> 
      <div style="display: flex; flex-direction: row; justify-content: space-between; padding-left: 1rem; padding-right: 1rem; margin-bottom: .5rem;">
        <h3>Subtotal <span style="font-weight: 100;">({{ cartItems.length }} items)</span></h3>
        <h3>&#8377; {{ getTotalPrice() }}</h3>
      </div>
      <button pButton label="Place Order" icon="pi pi-user" class="w-full" outlined 
        style="color: white; background-color: black; height: 3.5rem; border-radius:1rem; border: 2px solid black;" 
        (click)="placeOrder()">
      </button>
    </div>
  </ng-template>
</p-drawer>

<!-- for order history -->
<p-drawer header="Your Orders" [(visible)]="visible3" position="right" [style]="{ width: '35rem' }">
   <div *ngIf="orders.length === 0">
     <p>No orders found.</p>
   </div>
 
   <div *ngFor="let order of orders">
     <h3>Order ID: {{ order.orderId }}</h3>
     <p>Order Date: {{ order.orderDate | date:'medium' }}</p>
     <!-- <p>Total Price: ₹{{ order.totalPrice }}</p> -->
 
     <div style="border: 1px solid black; margin-bottom: 1rem; padding-left: 5px ">
       <p><strong>Order Details</strong></p>
       <div *ngFor="let detail of order.orderdetails" style="display: flex; justify-content: space-between; padding: 0.5rem 2rem;">
        <p>{{ detail.itemsDetails }}</p> <!-- Now contains item name -->
        <p>Qty: {{ detail.totalQuantity }}</p>
      </div>
      
       <div style="display: flex; justify-content: space-between; padding: 0.5rem 2rem; border-top: 1px solid black;">
         <p><strong>Total Quantity:</strong> {{ getTotalQuantity(order) }}</p>
         <p><strong>Total Price:</strong> ₹{{ order.totalPrice }}</p>
       </div>
     </div>
 
     <div style="border: 1px solid black; padding: 0.5rem; display: flex; ">
       <p><strong>Order Status:</strong></p>
       <p *ngFor="let status of order.orderstatuses">{{ status.status }}</p>
     </div>
   </div>
 </p-drawer>
 